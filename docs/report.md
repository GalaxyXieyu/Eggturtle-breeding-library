# 系统总览报告（拆分版）

更新时间：2026-03-01  
范围：Node 主线 `apps/web + apps/admin + apps/api`，并参考 `legacy/backend` 的繁育业务规则。

## 0. 当前结论

这套系统已形成可运行的多租户 SaaS 主链路：

1. Web 负责租户内种龟档案、图片、公开分享与展示。
2. Admin 负责跨租户运维（租户、成员、订阅、审计）。
3. API 负责认证、租户隔离、RBAC、订阅写保护。
4. 分享策略已简化：不限制链接创建次数，主控“可管理种龟数量 + 写状态”。
5. AI 策略已定：各套餐有次数上限，可多次充值叠加（当前支付与入账仍是占位）。

## 1. 报告拆分说明

按你的要求，原 `report.md` 的详细内容已拆到两个专项文档：

| 主题 | 现存文档 | 内容 |
|---|---|---|
| 前后端路由/接口全量清单 | `docs/api-views.md` | 页面路由 -> API 映射、后端接口分域清单、Controller 映射、Legacy 接口参照 |
| 技术与业务口径 | `docs/technical-reference.md` | 术语统一、待配/预警规则、加配/换配规则、子龟推导、数据模型字段索引、待确认项 |

## 2. 当前业务口径（执行版）

- 业务实体：统一为 `product`（繁育语义下可视作种龟档案）。
- 展示与成交：通过 `public_shares + tenant_feed` 完成公开传播。
- 套餐核心：按种龟数量分档；分享链接不做复杂配额。
- AI 策略：
  - 免费版体验额度（自动记录 10 次/月）
  - 全档位有次数上限
  - 支持多次充值叠加
  - 首页大数字展示剩余次数

## 3. 仍待实现的能力缺口

1. 证书主链路未打通：前端有生成组件，但缺后端签发/验真域模型与接口。
2. AI 充值闭环未打通：订单未落库、支付回调未接、额度流水未接。
3. AI 自动记录仍是“意图预览”，尚未接管理员智能体自动入库。
4. 智能问数仍是“占位接口”，未接 SQL 安全查询与结果解释层。

## 4. 噪音与仓库卫生（状态）

- 已执行删除（A 批次）：
  - `.DS_Store` / `docs/.DS_Store`
  - `apps/web/.next.bak*`
  - `out/**/*.log`
- 保留（按你要求不删）：
  - `.data`
  - `out`
  - `legacy`
  - 可重建目录（`.next`、`dist`）

## 5. 阅读顺序建议

1. 先读 `docs/business-flows.md`（商业叙事与套餐口径）。
2. 再读 `docs/api-views.md`（页面/接口怎么串）。
3. 最后读 `docs/technical-reference.md`（规则细节与可执行约束）。
